<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>astro procs</TITLE>
</head>
 
<body>
<H1>astro procs</H1>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help</CODE>.  For more information on 
this routine, refer to the IDL Online Help Navigator 
or type: <P>
<PRE>     ? mk_html_help</PRE><P>
at the IDL command line prompt.<P>
<STRONG>Last modified: </STRONG>Tue Dec 20 11:48:25 2005.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>List of Routines</H1></A>
<UL>
<LI><A HREF="#CHDOPPLER">CHDOPPLER</A>
<LI><A HREF="#DOPPLER">DOPPLER</A>
<LI><A HREF="#EQ2AZ">EQ2AZ</A>
<LI><A HREF="#EQTOAZ -- CONVERT HA, DEC TO AZ, ZA OR VICE VERSA">
EQTOAZ -- CONVERT HA, DEC TO AZ, ZA OR VICE VERSA</A>
<LI><A HREF="#LDS">LDS</A>
<LI><A HREF="#LSRVEL -- GIVE LSR VELOCITY TOWARDS AN RA, DEC">
LSRVEL -- GIVE LSR VELOCITY TOWARDS AN RA, DEC</A>
<LI><A HREF="#MAKE_LDS_CUBE">MAKE_LDS_CUBE</A>
<LI><A HREF="#MODANGLE360 --  CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.">
MODANGLE360 --  CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.</A>
<LI><A HREF="#SPHERICAL1_TO_SPHERICAL2">SPHERICAL1_TO_SPHERICAL2</A>
<LI><A HREF="#VTOBIN">VTOBIN</A>
</UL><P>
 
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="CHDOPPLER">
<H2>CHDOPPLER</H2></A>
<A HREF="#DOPPLER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: chdoppler
       
 PURPOSE: 
       computes the projected velocity of the telescope wrt 
       four coordinate systems: geo, helio, bary, lsr.
	negative velocities mean approach

       the standard LSR is defined as follows: the sun moves at 20.0 km/s
       toward ra=18.0h, dec=30.0 deg in 1900 epoch coords

 CALLING SEQUENCE:
        result = chdoppler( ra, dec, julday, obspos_deg=obspos_deg, path=path, light=light)

 INPUTS: fully vectorized...
       ra[n] - the source ra in decimal hours, equinox 2000
       dec[n] - the source dec in decimal hours, equinox 2000
	julday[n] - the julian day

 KEYWORDS:
	/obspos_deg: observatory [lat, wlong] in degrees. default is arecibo.
	/path - path for the station file. obspos_deg takes precedence.
       /light - returns the velocity as a fraction of c

 NOTE:
	if path is not specified, default long, lat are arecibo. if
path is specified, it reads long, lat from the file
		path + .station

 OUTPUTS: 
       program returns the velocity in km/s, or as a faction of c if
       the keyword /light is specified. the result is a 4-element
	vector whose elements are [geo, helio, bary, lsr]. quick
	comparison with phil's C doppler routines gives agreement to 
	better than 100 m/s one arbitrary case.

 REVISION HISTORY: carlh 29oct04. 
	from idoppler_ch; changed calculation epoch to 2000
	19nov04: correct bad earth spin calculation
	7 jun 2005: vectorize to make faster for quantity calculations.
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/chdoppler.pro)</STRONG><P>
<HR>
 
<A NAME="DOPPLER">
<H2>DOPPLER</H2></A>
<A HREF="#CHDOPPLER">[Previous Routine]</A>
<A HREF="#EQ2AZ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: DOPPLER

PURPOSE:
	GIVE DOPPLER VELOCITY KM/S WITH RESPECT TO BARYCENTER AND ALSO LSR. 

CALLING SEQUENCE:
	doppler, ra_hrs, dec_deg, equinox, julday, obslongitude, obslatitude, $
	v_barycen, v_lsr

INPUTS:
	RA, DEC ARE OF THE SPECIFIED EQUINOX. UNITS ARE DECIMAL HOURS, DEGREES
	EQUINOX: EQUINOX OF THE RA, DEC, IN YEARS. E.G. 2000.	
	JULDAY: THE JULIAN DAY IN DBL PRECISION, TELLS THE EXACT TIME.
	OBSLONGITUDE, OBSLATITUDE: OBSERVER'S LONGITUDE, LATITUDE IN DEGREES.
		LONGITUDE IS WEST LONG, E.G. CALIFORNIA IS +122.
		IF LATITUDE LT ZERO, IT GIVES VELOCITY OF EARTH'S CENTER.

OUTPUTS:
	V_BARYCEN IS VELOCITY WRT BARYCENTER AND V_LSR IS WRT LSR. 
		NEGATIVE VELOCITIES MEAN APPROACH, OR
		HIGHER FREQUENCIES FROM THE DOPPLER SHIFT

COMMENTS, RESTRICTIONS, ETC:
	THE LSR IS BASED ON THE CLASSIC RADIO ASTRONOMY ONE, 
		20 KM/S TOWARDS (RA,DEC)_1900 = (18:00, 30:00)
	WE NEGLECT THE OBSERVER'S HEIGHT ABOVE SEA LEVEL. THIS ISN'T
		GOOD FOR HIGH PLACES LIKE MAUNA KEA!
	ACCURACY SHOULD BE 1 M/S. BASED ON GSFC BARYVEL.

TO COMPUTE JULDAY, YOU CAN USE JDCNV. EXAMPLE: GMT 5.5 HRS ON 15-FEB-1994,
	JDCNV, 1994, 2, 15, 5.5, JULDAY

</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/doppler.pro)</STRONG><P>
<HR>
 
<A NAME="EQ2AZ">
<H2>EQ2AZ</H2></A>
<A HREF="#DOPPLER">[Previous Routine]</A>
<A HREF="#EQTOAZ -- CONVERT HA, DEC TO AZ, ZA OR VICE VERSA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       EQ2AZ

 PURPOSE:
       To convert between the HOUR ANGLE-DECLINATION and AZIMUTH-ZENITH 
       ANGLE coordinate systems.

 CALLING SEQUENCE:
       EQ2AZ, ha, dec, az, za, latitude [, /REVERSE]

 INPUTS:
       latitude  - the latitude (a scalar) of the observatory, measured 
                   in decimal degrees

 KEYWORD PARAMETERS:
       /REVERSE : if this keyword is set, the program takes the azimuth 
                  and zenith angle as inputs and returns the hour angle 
                  and the declination.  The default behavior, as the module 
                  name suggests, is to return the azimuth and zenith angle 
                  given the hour angle and declination.

 INPUTS OR OUTPUTS (DEPENDING ON /REVERSE KEYWORD) :
       ha  - hour angle, measured in decimal hours; scalar or array
       dec - declination, measured in decimal degrees; scalar or array
       az  - azimuth, measured in decimal degrees; scalar or array
       za  - zenith angle (the complementary angle to the elevation), 
             measured in decimal degrees; scalar or array

 COMMON BLOCKS:
       None.

 RESTRICTIONS:
       Hour angle must be given in decimal hours.  Declination, azimuth,
       zenith angle, and latitude must be given in decimal degrees.

 EXAMPLE:
       Find the azimuth and zenith angle of Altair [RA (J2000): 19 50 47 
       Dec (J2000): 08 52 06] at LST 19h at Arecibo [LONG: 66 45 10.8
       LAT: 18 21 14.2]

       IDL> eq2az, 19.0-ten(19,50,47), ten(08,52,06), az, za, $
       IDL> ten(18,21,14.2)
       IDL> help, az, za
       AZ              DOUBLE    =        125.90073
       ZA              DOUBLE    =        15.549609

 NOTES:
       Went through pain to assure that if a scalar is input, a scalar 
       is returned, but even more pain to allow multi-dimensional
       arrays to be input (and to make the output have the same 
       dimensions!) Also, if inputs are double precision, the calculations 
       will be done in double precision.  The azimuth is returned in the 
       range 0 -> 360 degrees.

 MODIFICATION HISTORY:
       20 May 2004  Written by Tim Robishaw, Berkeley
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/eq2az.pro)</STRONG><P>
<HR>
 
<A NAME="EQTOAZ -- CONVERT HA, DEC TO AZ, ZA OR VICE VERSA">
<H2>EQTOAZ -- CONVERT HA, DEC TO AZ, ZA OR VICE VERSA</H2></A>
<A HREF="#EQ2AZ">[Previous Routine]</A>
<A HREF="#LDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
eqtoaz -- CONVERT HA, DEC TO AZ, ZA or vice versa
CONVERT HA, DEC TO AZ, ZA IF DIRECTION=+1
CONVERT AZ, ZA TO ZA, DEC IF DIRECTION=-1
HA, DEC ARE IN DECIMAL HRS, DEG
AZ, ZA ARE IN DECIMAL DEG, DEG

IN COMMON ANGLESTUFF, OBSLONG AND OBSLAT ARE ASSUMED TO BE IN DEGREES.
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/eqtoaz.pro)</STRONG><P>
<HR>
 
<A NAME="LDS">
<H2>LDS</H2></A>
<A HREF="#EQTOAZ -- CONVERT HA, DEC TO AZ, ZA OR VICE VERSA
">[Previous Routine]</A>
<A HREF="#LSRVEL -- GIVE LSR VELOCITY TOWARDS AN RA, DEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       LDS
     
 PURPOSE:

     
 EXPLANATION:

     
 CALLING SEQUENCE:

     
 INPUTS:

     
 OPTIONAL INPUTS:

     
 OUTPUTS:


 OPTIONAL OUTPUTS:


 KEYWORDS:


 COMMON BLOCKS:


 SIDE EFFECTS:


 RESTRICTIONS:


 PROCEDURES CALLED:
       PLOTSPECTRUM
       ZOOMIN
       AVERAGE
       TZOOMIN
       FITSPEC
       PS_SPEC_EVENT
       PS_SPEC
       SELECT_EVENT
       SELECT

       ROUNDTOHALF
       VTOBIN

       GETMEAN
       CUTOFF
       MODEL
       INDIPLOT
       CLEAR
       FITLDS
       EDGECORRECTION
       GFIT
       GCURV

 EXAMPLE:


 NOTES:


 RELATED PROCEDURES:


 MODIFICATION HISTORY:
       Written Tim Robishaw, Berkeley
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/lds.pro)</STRONG><P>
<HR>
 
<A NAME="LSRVEL -- GIVE LSR VELOCITY TOWARDS AN RA, DEC">
<H2>LSRVEL -- GIVE LSR VELOCITY TOWARDS AN RA, DEC</H2></A>
<A HREF="#LDS">[Previous Routine]</A>
<A HREF="#MAKE_LDS_CUBE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
LSRVEL -- give LSR velocity towards an ra, dec

PURPOSE:
	GIVE THE COMPONENT OF LSR VELOCITY TOWARDS THE GIVEN ELL, BEE
	'LSR' MOVES WITH 20.000 KM/S TOWARDS ra1900, dec1900 = 18.000, 30.000

CALLING SEQUENCE:
	LSRVEL, RA_EPOCH, DEC_EPOCH, EQUINOX, VLSR

INPUTS:
	RA_EPOCH: the R.A. of the position, DECIMAL HOURS.
	DEC_EPOCH, THE DEC IN DECIMAL DEGREES.
	EQUINOX: THE EQUINOX OF THE POSITIONS, E.G. 2000.

OUTPUTS:
	DELVLSR: the velocity in the LSR frame.

HISTORY:
	Written by Carl Heiles. 12 JUN 2000.

IF YOU NEED TO CONVERT FROM GALACTIC TO EQUATORIAL BEFORE ENTERING THIS:
CONVERT INPUT GALACTIC COORDS TO 1900 EPOCH EQUATORIAL COORDS...
	glactc, ra1900, dec1900, 1900.0, ell, bee, 1
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/lsrvel.pro)</STRONG><P>
<HR>
 
<A NAME="MAKE_LDS_CUBE">
<H2>MAKE_LDS_CUBE</H2></A>
<A HREF="#LSRVEL -- GIVE LSR VELOCITY TOWARDS AN RA, DEC">[Previous Routine]</A>
<A HREF="#MODANGLE360 --  CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.
">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       MAKE_LDS_CUBE

 PURPOSE:
       To make an (l,b,v) cube of a subset of the Leiden/Dwingeloo Survey 
       of Galactic neutral hydrogen.

 CALLING SEQUENCE:
       make_lds_cube, lcen, bcen, dl, db [, VRANGE=[min,max]] 
                      [, FILENAME=string]

 INPUTS:
       lcen - central Galactic longitude of cube [degrees]
       bcen - central Galactic latitude of cube [degrees]
       dl - the half-width of the cube in the longitude direction[degrees]
       db - the half-width of the cube in the latitude direction [degrees]

 KEYWORD PARAMETERS:
       VRANGE = 2-element vector with minimum and maximum VLSR velocities 
                [km/s] in the cube.  Default is to use entire velocity
                range.
       FILENAME = name of the output FITS file.  Default is to write to a
                  file named lds_cube.fits in the current working directory.

 OUTPUTS:
       None.

 COMMON BLOCKS:
       None.

 SIDE EFFECTS:
       A FITS cube is written.

 PROCEDURES CALLED:
       TABINV, FITS_ADD_AXIS_PAR

 EXAMPLE:
       IDL> make_lds_cube, 90, 0, 30, 10, VRANGE=[-100,100]

 MODIFICATION HISTORY:
       15 Sep 2004  Written by Tim Robishaw, Berkeley
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/make_lds_cube.pro)</STRONG><P>
<HR>
 
<A NAME="MODANGLE360 --  CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.">
<H2>MODANGLE360 --  CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.</H2></A>
<A HREF="#MAKE_LDS_CUBE">[Previous Routine]</A>
<A HREF="#SPHERICAL1_TO_SPHERICAL2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
modangle360 --  CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.
 CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.
 ALL ANGLES ARE IN DEGREES.
 if negpos is set, interval is -180 to 180
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/modangle360.pro)</STRONG><P>
<HR>
 
<A NAME="SPHERICAL1_TO_SPHERICAL2">
<H2>SPHERICAL1_TO_SPHERICAL2</H2></A>
<A HREF="#MODANGLE360 --  CONVERT ANGLES TO THE INTERVAL 0 TO 360 DEG.
">[Previous Routine]</A>
<A HREF="#VTOBIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME
spherical1_to_spherical2 -- CONVERTS LONGITUDE AND LATITUDE between 2 systems

purpose:
CONVERTS LONGITUDE AND LATITUDE IN SYSTEM 1 TO THOSE IN SYSTEM 2
USES THE ROTATION MATRIX RTOT
ALL ANGLES ARE IN ***DEGREES***.
VECTORIZED BUT REUTNRS ALL INPUTS IN 1-D.
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/spherical1_to_spherical2.pro)</STRONG><P>
<HR>
 
<A NAME="VTOBIN">
<H2>VTOBIN</H2></A>
<A HREF="#SPHERICAL1_TO_SPHERICAL2">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   vtobin
     
 PURPOSE:
   Finds the bin number(s) in a velocity vector closest to some v.
     
 CALLING SEQUENCE:
   bin = vtobin(vlsr, v)
     
 INPUTS:
   vlsr : velocity vector
   v    : velocity or velocities whose corresponding bins you want
     
 REVISION HISTORY:
   17-Nov-2000 Written T. Robishaw, Berkeley
</PRE><P>
<STRONG>(See /dzd2/heiles/idl/gen/astro/vtobin.pro)</STRONG><P>
<HR>
 
</body>
</html>
